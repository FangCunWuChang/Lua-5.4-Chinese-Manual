### 2.1 – 值与类型  
Lua是一个动态类型语言。这意味着变量声明时无需声明类型，只需赋值即可。所有的值都对应着各自的类型。  

Lua中所有的值都是头等值（函数名和变量名之间没有区别，它们可以相互赋值），这意味着所有的值都可以被存入变量、作为参数传递给函数以及作为函数的结果返回。  

Lua中有8种基本类型：*nil*,*boolean*,*number*,*string*,*function*,*userdata*,*thread*和*table*。只有一种值是*nil*类型，**nil**，它具有与其他值不同的性质；它通常表示缺少有用的值。*boolean*类型有两种值，**false**和**true**。**nil**和**false**都表示“假”的状态，它们统称“假值”。其它任意的值都表示“真”的状态。如果不在意名字的话，**false**可以经常被用于代替**nil**，二者的区别在于**false**可以表示表中的一个实际键值，而将表中某个键的键值设为**nil**表示从表中删除这个键。  

*number*类型使用两个子类型*integer*和*float*表示整数和浮点数，标准的Lua使用64位精度整数和双精度浮点数（64位），不过你可以通过自行编译Lua来使用32位整数和单精度浮点数（32位）。使用32位数值可以在配置低的计算机和嵌入式设备上节约运行开销。（详见*luaconf.h*中*LUA_32BITS*宏）  

除非另有说明，否则在处理整数值时，根据二进制补码运算规则，算数溢出将会导致虚拟机舍去多余的位数。（换言之，溢出时获得的实际结果是数学结果对2^n取模获得的整数值，n为整数值的位数）  

Lua有明确的规则来确定数值为整数或浮点数，但是可以根据需求自动地在两种类型间进行转换（详见3.4.3节）。因此，开发者可以选择完全忽略二者间的区别或者手动控制每个数值的类型。  

*string*类型表示一串固定的字节序列，Lua使用8位对齐：字符串中可以包含任何8位的值，包括嵌入零(*'\\0'*)。Lua字符串是编码不可知的，它不会对字符串的内容做出任何假设。*string*类型的长度必须在Lua整数类型的范围内。  

Lua可以调用（并控制）Lua函数和C函数（详见3.4.10节），它们都以*function*类型表示。  

*userdata*类型提供了将任意C语言数据存入Lua变量的功能。*userdata*类型的值提供了一块内存。*userdata*分为两种：*full userdata*，一个储存在一块由Lua管理的内存块中的对象；*light userdata*，一个C指针值。Userdata在Lua中没有预定义的操作，分配和类型检验除外。通过使用*metatables*，开发者可以给full userdata值定义操作（详见2.4节）。Userdata值不可以在Lua中创建和修改，上述操作只能使用C API进行。这保证了主程序和C语言库的数据完整性。  

*thread*类型用于提供独立的执行线程，可以用来实现协程（详见2.6节）。Lua线程与系统线程无关。Lua支持在所有系统上建立协程，即使系统没有原生支持线程。  

*table*类型实现了关联数组，即数组的索引不仅可以为整数值，还可以是除**nil**和**NaN**外的任意Lua值。（NaN，即Not a Number，是在IEEE 754标准中定义的一个特殊的浮点数值，用于表示未定义的运算结果，如0/0。）表可以是异构的，这意味着表中可以储存任意类型的值（**nil**除外）。任何对应**nil**值的键都不会被认为存在于表中。同时所有不存在于表中的键所对应的值都为**nil**。  

表是Lua中唯一的数据结构机制，它们可以用来表示普通数组、列表、符号表、集合、记录、图形、树等。当表用于表示记录时，Lua使用字段名作为索引（即键）。Lua支持使用`a.name`的形式作为`a["name"]`的语法糖。Lua提供了一些便捷的途径来建立表（详见3.4.9节）。  

和索引一样，表中的值可以是任意类型。因为函数也是头等值，所以表中可以包含函数。因此表也可以具有方法（详见3.4.11节）。  

表的索引遵循Lua中“相等”的定义。例如当且仅当i等于（在没有元方法的情况下）j时，`a[i]`和`a[j]`表示表中同一个元素。整数的浮点值等于相应的整数值（如`1.0==1`）。为避免歧义，用作键的以浮点数形式表达的整数会被转换成相应的整数。例如，如果你定义`a[2.0]=true`，则表中相应的键为*integer*类型的**2**。  

表，函数，线程和（full）userdata值都是对象：变量实际上并不存放这些值，只存放对它们的引用。赋值、参数传递和函数返回都只是对这些值的引用的操作，这些操作并不会对值进行复制。  

库函数*type*返回一个表示相应值的类型的字符串（详见type节）。  